CREATE DATABASE IF NOT EXISTS `college_1`;

drop table if exists `college_1`.`EMPLOYEE`;
CREATE TABLE IF NOT EXISTS `college_1`.`EMPLOYEE` (
    `EMP_NUM` INT,
    `EMP_LNAME` STRING,
    `EMP_FNAME` STRING,
    `EMP_INITIAL` STRING,
    `EMP_JOBCODE` STRING,
    `EMP_HIREDATE` TIMESTAMP,
    `EMP_DOB` TIMESTAMP,
    PRIMARY KEY (`EMP_NUM`) DISABLE NOVALIDATE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
tblproperties("skip.header.line.count"="1")
;
LOAD DATA INPATH '${DATASET_DIR}/college_1/data/EMPLOYEE.csv' INTO TABLE `college_1`.`EMPLOYEE`;


drop table if exists `college_1`.`DEPARTMENT`;
CREATE TABLE IF NOT EXISTS `college_1`.`DEPARTMENT` (
    `DEPT_CODE` STRING,
    `DEPT_NAME` STRING,
    `SCHOOL_CODE` STRING,
    `EMP_NUM` INT,
    `DEPT_ADDRESS` STRING,
    `DEPT_EXTENSION` STRING,
    PRIMARY KEY (`DEPT_CODE`) DISABLE NOVALIDATE,
    FOREIGN KEY (`EMP_NUM`) REFERENCES `college_1`.`EMPLOYEE` (`EMP_NUM`) DISABLE NOVALIDATE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
tblproperties("skip.header.line.count"="1")
;
LOAD DATA INPATH '${DATASET_DIR}/college_1/data/DEPARTMENT.csv' INTO TABLE `college_1`.`DEPARTMENT`;


drop table if exists `college_1`.`COURSE`;
CREATE TABLE IF NOT EXISTS `college_1`.`COURSE` (
    `CRS_CODE` STRING,
    `DEPT_CODE` STRING,
    `CRS_DESCRIPTION` STRING,
    `CRS_CREDIT` DECIMAL(8),
    PRIMARY KEY (`CRS_CODE`) DISABLE NOVALIDATE,
    FOREIGN KEY (`DEPT_CODE`) REFERENCES `college_1`.`DEPARTMENT` (`DEPT_CODE`) DISABLE NOVALIDATE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
tblproperties("skip.header.line.count"="1")
;
LOAD DATA INPATH '${DATASET_DIR}/college_1/data/COURSE.csv' INTO TABLE `college_1`.`COURSE`;


drop table if exists `college_1`.`CLASS`;
CREATE TABLE IF NOT EXISTS `college_1`.`CLASS` (
    `CLASS_CODE` STRING,
    `CRS_CODE` STRING,
    `CLASS_SECTION` STRING,
    `CLASS_TIME` STRING,
    `CLASS_ROOM` STRING,
    `PROF_NUM` INT,
    PRIMARY KEY (`CLASS_CODE`) DISABLE NOVALIDATE,
    FOREIGN KEY (`PROF_NUM`) REFERENCES `college_1`.`EMPLOYEE` (`EMP_NUM`) DISABLE NOVALIDATE,
    FOREIGN KEY (`CRS_CODE`) REFERENCES `college_1`.`COURSE` (`CRS_CODE`) DISABLE NOVALIDATE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
tblproperties("skip.header.line.count"="1")
;
LOAD DATA INPATH '${DATASET_DIR}/college_1/data/CLASS.csv' INTO TABLE `college_1`.`CLASS`;


drop table if exists `college_1`.`STUDENT`;
CREATE TABLE IF NOT EXISTS `college_1`.`STUDENT` (
    `STU_NUM` INT,
    `STU_LNAME` STRING,
    `STU_FNAME` STRING,
    `STU_INIT` STRING,
    `STU_DOB` TIMESTAMP,
    `STU_HRS` INT,
    `STU_CLASS` STRING,
    `STU_GPA` DECIMAL(8),
    `STU_TRANSFER` NUMERIC,
    `DEPT_CODE` STRING,
    `STU_PHONE` STRING,
    `PROF_NUM` INT,
    PRIMARY KEY (`STU_NUM`) DISABLE NOVALIDATE,
    FOREIGN KEY (`DEPT_CODE`) REFERENCES `college_1`.`DEPARTMENT` (`DEPT_CODE`) DISABLE NOVALIDATE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
tblproperties("skip.header.line.count"="1")
;
LOAD DATA INPATH '${DATASET_DIR}/college_1/data/STUDENT.csv' INTO TABLE `college_1`.`STUDENT`;


drop table if exists `college_1`.`ENROLL`;
CREATE TABLE IF NOT EXISTS `college_1`.`ENROLL` (
    `CLASS_CODE` STRING,
    `STU_NUM` INT,
    `ENROLL_GRADE` STRING,
    FOREIGN KEY (`STU_NUM`) REFERENCES `college_1`.`STUDENT` (`STU_NUM`) DISABLE NOVALIDATE,
    FOREIGN KEY (`CLASS_CODE`) REFERENCES `college_1`.`CLASS` (`CLASS_CODE`) DISABLE NOVALIDATE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
tblproperties("skip.header.line.count"="1")
;
LOAD DATA INPATH '${DATASET_DIR}/college_1/data/ENROLL.csv' INTO TABLE `college_1`.`ENROLL`;


drop table if exists `college_1`.`PROFESSOR`;
CREATE TABLE IF NOT EXISTS `college_1`.`PROFESSOR` (
    `EMP_NUM` INT,
    `DEPT_CODE` STRING,
    `PROF_OFFICE` STRING,
    `PROF_EXTENSION` STRING,
    `PROF_HIGH_DEGREE` STRING,
    FOREIGN KEY (`DEPT_CODE`) REFERENCES `college_1`.`DEPARTMENT` (`DEPT_CODE`) DISABLE NOVALIDATE,
    FOREIGN KEY (`EMP_NUM`) REFERENCES `college_1`.`EMPLOYEE` (`EMP_NUM`) DISABLE NOVALIDATE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
tblproperties("skip.header.line.count"="1")
;
LOAD DATA INPATH '${DATASET_DIR}/college_1/data/PROFESSOR.csv' INTO TABLE `college_1`.`PROFESSOR`;

