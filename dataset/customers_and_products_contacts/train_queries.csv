question,sql
How many addresses are there in country USA?,SELECT COUNT(*) FROM `Addresses` WHERE `country` = 'USA'
Show all distinct cities in the address record.,SELECT DISTINCT `city` FROM `Addresses`
Show each state and the number of addresses in each state.,"SELECT `state_province_county`, COUNT(*) FROM `Addresses` GROUP BY `state_province_county`"
Show names and phones of customers who do not have address information.,"SELECT `customer_name`, `customer_phone` FROM `Customers` WHERE NOT `customer_id` IN (SELECT `customer_id` FROM `Customer_Address_History`)"
Show the name of the customer who has the most orders.,SELECT `t1`.`customer_name` FROM `Customers` AS `t1` JOIN `Customer_Orders` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` GROUP BY `t1`.`customer_name` ORDER BY COUNT(*) DESC LIMIT 1
Show the product type codes which have at least two products.,SELECT `product_type_code` FROM `Products` GROUP BY `product_type_code` HAVING COUNT(*) >= 2
Show the names of customers who have both an order in completed status and an order in part status.,SELECT `t1`.`customer_name` FROM `Customers` AS `t1` JOIN `Customer_Orders` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `t2`.`order_status_code` = 'Completed' INTERSECT SELECT `t1`.`customer_name` FROM `Customers` AS `t1` JOIN `Customer_Orders` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `t2`.`order_status_code` = 'Part'
"Show the name, phone, and payment method code for all customers in descending order of customer number.","SELECT `customer_name`, `customer_phone`, `payment_method_code` FROM `Customers` ORDER BY `customer_number` DESC"
Show the product name and total order quantity for each product.,"SELECT `t1`.`product_name`, SUM(`t2`.`order_quantity`) FROM `Products` AS `t1` JOIN `Order_Items` AS `t2` ON `t1`.`product_id` = `t2`.`product_id` GROUP BY `t1`.`product_name`"
"Show the minimum, maximum, average price for all products.","SELECT MIN(`product_price`), MAX(`product_price`), AVG(`product_price`) FROM `Products`"
How many products have a price higher than the average?,SELECT COUNT(*) FROM `Products` WHERE `product_price` > (SELECT AVG(`product_price`) FROM `Products`)
"Show the customer name, customer address city, date from, and date to for each customer address history.","SELECT `t2`.`customer_name`, `t3`.`city`, `t1`.`date_from`, `t1`.`date_to` FROM `Customer_Address_History` AS `t1` JOIN `Customers` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` JOIN `Addresses` AS `t3` ON `t1`.`address_id` = `t3`.`address_id`"
Show the names of customers who use Credit Card payment method and have more than 2 orders.,SELECT `t1`.`customer_name` FROM `Customers` AS `t1` JOIN `Customer_Orders` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `t1`.`payment_method_code` = 'Credit Card' GROUP BY `t1`.`customer_name` HAVING COUNT(*) > 2
What are the name and phone of the customer with the most ordered product quantity?,"SELECT `t1`.`customer_name`, `t1`.`customer_phone` FROM `Customers` AS `t1` JOIN `Customer_Orders` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` JOIN `Order_Items` AS `t3` ON `t3`.`order_id` = `t2`.`order_id` GROUP BY `t1`.`customer_name`, `t1`.`customer_phone` ORDER BY SUM(`t3`.`order_quantity`) DESC LIMIT 1"
Show the product type and name for the products with price higher than 1000 or lower than 500.,"SELECT `product_type_code`, `product_name` FROM `Products` WHERE `product_price` > 1000 OR `product_price` < 500"
