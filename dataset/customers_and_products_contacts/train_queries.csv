question,sql
How many addresses are there in country USA?,SELECT COUNT(*) FROM `addresses` WHERE `country` = 'USA'
Show all distinct cities in the address record.,SELECT DISTINCT `city` FROM `addresses`
Show each state and the number of addresses in each state.,"SELECT `state_province_county`, COUNT(*) FROM `addresses` GROUP BY `state_province_county`"
Show names and phones of customers who do not have address information.,"SELECT `customer_name`, `customer_phone` FROM `customers` WHERE NOT `customer_id` IN (SELECT `customer_id` FROM `customer_address_history`)"
Show the name of the customer who has the most orders.,SELECT `T1`.`customer_name` FROM `customers` AS `T1` JOIN `customer_orders` AS `T2` ON `T1`.`customer_id` = `T2`.`customer_id` GROUP BY `T1`.`customer_id` ORDER BY COUNT(*) DESC LIMIT 1
Show the product type codes which have at least two products.,SELECT `product_type_code` FROM `products` GROUP BY `product_type_code` HAVING COUNT(*) >= 2
Show the names of customers who have both an order in completed status and an order in part status.,SELECT `T1`.`customer_name` FROM `customers` AS `T1` JOIN `customer_orders` AS `T2` ON `T1`.`customer_id` = `T2`.`customer_id` WHERE `T2`.`order_status_code` = 'Completed' INTERSECT SELECT `T1`.`customer_name` FROM `customers` AS `T1` JOIN `customer_orders` AS `T2` ON `T1`.`customer_id` = `T2`.`customer_id` WHERE `T2`.`order_status_code` = 'Part'
"Show the name, phone, and payment method code for all customers in descending order of customer number.","SELECT `customer_name`, `customer_phone`, `payment_method_code` FROM `customers` ORDER BY `customer_number` DESC"
Show the product name and total order quantity for each product.,"SELECT `T1`.`product_name`, SUM(`T2`.`order_quantity`) FROM `products` AS `T1` JOIN `order_items` AS `T2` ON `T1`.`product_id` = `T2`.`product_id` GROUP BY `T1`.`product_id`"
"Show the minimum, maximum, average price for all products.","SELECT MIN(`product_price`), MAX(`product_price`), AVG(`product_price`) FROM `products`"
How many products have a price higher than the average?,SELECT COUNT(*) FROM `products` WHERE `product_price` > (SELECT AVG(`product_price`) FROM `products`)
"Show the customer name, customer address city, date from, and date to for each customer address history.","SELECT `T2`.`customer_name`, `T3`.`city`, `T1`.`date_from`, `T1`.`date_to` FROM `customer_address_history` AS `T1` JOIN `customers` AS `T2` ON `T1`.`customer_id` = `T2`.`customer_id` JOIN `addresses` AS `T3` ON `T1`.`address_id` = `T3`.`address_id`"
Show the names of customers who use Credit Card payment method and have more than 2 orders.,SELECT `T1`.`customer_name` FROM `customers` AS `T1` JOIN `customer_orders` AS `T2` ON `T1`.`customer_id` = `T2`.`customer_id` WHERE `T1`.`payment_method_code` = 'Credit Card' GROUP BY `T1`.`customer_id` HAVING COUNT(*) > 2
What are the name and phone of the customer with the most ordered product quantity?,"SELECT `T1`.`customer_name`, `T1`.`customer_phone` FROM `customers` AS `T1` JOIN `customer_orders` AS `T2` ON `T1`.`customer_id` = `T2`.`customer_id` JOIN `order_items` AS `T3` ON `T3`.`order_id` = `T2`.`order_id` GROUP BY `T1`.`customer_id` ORDER BY SUM(`T3`.`order_quantity`) DESC LIMIT 1"
Show the product type and name for the products with price higher than 1000 or lower than 500.,"SELECT `product_type_code`, `product_name` FROM `products` WHERE `product_price` > 1000 OR `product_price` < 500"
