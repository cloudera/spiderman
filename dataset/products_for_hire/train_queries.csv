question,sql
Are the customers holding coupons with amount 500 bad or good?,SELECT `t1`.`good_or_bad_customer` FROM `Customers` AS `t1` JOIN `Discount_Coupons` AS `t2` ON `t1`.`coupon_id` = `t2`.`coupon_id` WHERE `t2`.`coupon_amount` = 500
"How many bookings did each customer make? List the customer id, first name, and the count.","SELECT `t1`.`customer_id`, `t1`.`first_name`, COUNT(*) FROM `Customers` AS `t1` JOIN `Bookings` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` GROUP BY `t1`.`customer_id`, `t1`.`first_name`"
What is the maximum total amount paid by a customer? List the customer id and amount.,"SELECT `customer_id`, SUM(`amount_paid`) FROM `Payments` GROUP BY `customer_id` ORDER BY SUM(`amount_paid`) DESC LIMIT 1"
What are the id and the amount of refund of the booking that incurred the most times of payments?,"SELECT `t1`.`booking_id`, `t1`.`amount_of_refund` FROM `Bookings` AS `t1` JOIN `Payments` AS `t2` ON `t1`.`booking_id` = `t2`.`booking_id` GROUP BY `t1`.`booking_id`, `t1`.`amount_of_refund` ORDER BY COUNT(*) DESC LIMIT 1"
What is the id of the product that is booked for 3 times?,SELECT `product_id` FROM `Products_Booked` GROUP BY `product_id` HAVING COUNT(*) = 3
What is the product description of the product booked with an amount of 102.76?,SELECT `t2`.`product_description` FROM `Products_Booked` AS `t1` JOIN `Products_for_Hire` AS `t2` ON `t1`.`product_id` = `t2`.`product_id` WHERE `t1`.`booked_amount` = 102.76
What are the start date and end date of the booking that has booked the product named 'Book collection A'?,"SELECT `t3`.`booking_start_date`, `t3`.`booking_end_date` FROM `Products_for_Hire` AS `t1` JOIN `Products_Booked` AS `t2` ON `t1`.`product_id` = `t2`.`product_id` JOIN `Bookings` AS `t3` ON `t2`.`booking_id` = `t3`.`booking_id` WHERE `t1`.`product_name` = 'Book collection A'"
What are the names of products whose availability equals to 1?,SELECT `t2`.`product_name` FROM `View_Product_Availability` AS `t1` JOIN `Products_for_Hire` AS `t2` ON `t1`.`product_id` = `t2`.`product_id` WHERE `t1`.`available_yn` = 1
How many different product types are there?,SELECT COUNT(DISTINCT `product_type_code`) FROM `Products_for_Hire`
"What are the first name, last name, and gender of all the good customers? Order by their last name.","SELECT `first_name`, `last_name`, `gender_mf` FROM `Customers` WHERE `good_or_bad_customer` = 'good' ORDER BY `last_name`"
What is the average amount due for all the payments?,SELECT AVG(`amount_due`) FROM `Payments`
"What are the maximum, minimum, and average booked count for the products booked?","SELECT MAX(`booked_count`), MIN(`booked_count`), AVG(`booked_count`) FROM `Products_Booked`"
What are all the distinct payment types?,SELECT DISTINCT `payment_type_code` FROM `Payments`
What are the daily hire costs for the products with substring 'Book' in its name?,SELECT `daily_hire_cost` FROM `Products_for_Hire` WHERE `product_name` LIKE '%Book%'
How many products are never booked with amount higher than 200?,SELECT COUNT(*) FROM `Products_for_Hire` WHERE NOT `product_id` IN (SELECT `product_id` FROM `Products_Booked` WHERE `booked_amount` > 200)
What are the coupon amount of the coupons owned by both good and bad customers?,SELECT `t1`.`coupon_amount` FROM `Discount_Coupons` AS `t1` JOIN `Customers` AS `t2` ON `t1`.`coupon_id` = `t2`.`coupon_id` WHERE `t2`.`good_or_bad_customer` = 'good' INTERSECT SELECT `t1`.`coupon_amount` FROM `Discount_Coupons` AS `t1` JOIN `Customers` AS `t2` ON `t1`.`coupon_id` = `t2`.`coupon_id` WHERE `t2`.`good_or_bad_customer` = 'bad'
What are the payment date of the payment with amount paid higher than 300 or with payment type is 'Check',SELECT `payment_date` FROM `Payments` WHERE `amount_paid` > 300 OR `payment_type_code` = 'Check'
What are the names and descriptions of the products that are of 'Cutlery' type and have daily hire cost lower than 20?,"SELECT `product_name`, `product_description` FROM `Products_for_Hire` WHERE `product_type_code` = 'Cutlery' AND `daily_hire_cost` < 20"
