question,sql
Which assets have 2 parts and have less than 2 fault logs? List the asset id and detail.,"SELECT `t1`.`asset_id`, `t1`.`asset_details` FROM `Assets` AS `t1` JOIN `Asset_Parts` AS `t2` ON `t1`.`asset_id` = `t2`.`asset_id` GROUP BY `t1`.`asset_id`, `t1`.`asset_details` HAVING COUNT(*) = 2 INTERSECT SELECT `t1`.`asset_id`, `t1`.`asset_details` FROM `Assets` AS `t1` JOIN `Fault_Log` AS `t2` ON `t1`.`asset_id` = `t2`.`asset_id` GROUP BY `t1`.`asset_id`, `t1`.`asset_details` HAVING COUNT(*) < 2"
How many assets does each maintenance contract contain? List the number and the contract id.,"SELECT COUNT(*), `t1`.`maintenance_contract_id` FROM `Maintenance_Contracts` AS `t1` JOIN `Assets` AS `t2` ON `t1`.`maintenance_contract_id` = `t2`.`maintenance_contract_id` GROUP BY `t1`.`maintenance_contract_id`"
How many assets does each third party company supply? List the count and the company id.,"SELECT COUNT(*), `t1`.`company_id` FROM `Third_Party_Companies` AS `t1` JOIN `Assets` AS `t2` ON `t1`.`company_id` = `t2`.`supplier_company_id` GROUP BY `t1`.`company_id`"
Which third party companies have at least 2 maintenance engineers or have at least 2 maintenance contracts? List the company id and name.,"SELECT `t1`.`company_id`, `t1`.`company_name` FROM `Third_Party_Companies` AS `t1` JOIN `Maintenance_Engineers` AS `t2` ON `t1`.`company_id` = `t2`.`company_id` GROUP BY `t1`.`company_id`, `t1`.`company_name` HAVING COUNT(*) >= 2 UNION SELECT `t3`.`company_id`, `t3`.`company_name` FROM `Third_Party_Companies` AS `t3` JOIN `Maintenance_Contracts` AS `t4` ON `t3`.`company_id` = `t4`.`maintenance_contract_company_id` GROUP BY `t3`.`company_id`, `t3`.`company_name` HAVING COUNT(*) >= 2"
What is the name and id of the staff who recorded the fault log but has not contacted any visiting engineers?,"SELECT `t1`.`staff_name`, `t1`.`staff_id` FROM `Staff` AS `t1` JOIN `Fault_Log` AS `t2` ON `t1`.`staff_id` = `t2`.`recorded_by_staff_id` EXCEPT SELECT `t3`.`staff_name`, `t3`.`staff_id` FROM `Staff` AS `t3` JOIN `Engineer_Visits` AS `t4` ON `t3`.`staff_id` = `t4`.`contact_staff_id`"
"Which engineer has visited the most times? Show the engineer id, first name and last name.","SELECT `t1`.`engineer_id`, `t1`.`first_name`, `t1`.`last_name` FROM `Maintenance_Engineers` AS `t1`, `Engineer_Visits` AS `t2` GROUP BY `t1`.`engineer_id`, `t1`.`first_name`, `t1`.`last_name` ORDER BY COUNT(*) DESC LIMIT 1"
Which parts have more than 2 faults? Show the part name and id.,"SELECT `t1`.`part_name`, `t1`.`part_id` FROM `Parts` AS `t1` JOIN `Part_Faults` AS `t2` ON `t1`.`part_id` = `t2`.`part_id` GROUP BY `t1`.`part_name`, `t1`.`part_id` HAVING COUNT(*) > 2"
"List all every engineer's first name, last name, details and coresponding skill description.","SELECT `t1`.`first_name`, `t1`.`last_name`, `t1`.`other_details`, `t3`.`skill_description` FROM `Maintenance_Engineers` AS `t1` JOIN `Engineer_Skills` AS `t2` ON `t1`.`engineer_id` = `t2`.`engineer_id` JOIN `Skills` AS `t3` ON `t2`.`skill_id` = `t3`.`skill_id`"
"For all the faults of different parts, what are all the decriptions of the skills required to fix them? List the name of the faults and the skill description.","SELECT `t1`.`fault_short_name`, `t3`.`skill_description` FROM `Part_Faults` AS `t1` JOIN `Skills_Required_To_Fix` AS `t2` ON `t1`.`part_fault_id` = `t2`.`part_fault_id` JOIN `Skills` AS `t3` ON `t2`.`skill_id` = `t3`.`skill_id`"
How many assets can each parts be used in? List the part name and the number.,"SELECT `t1`.`part_name`, COUNT(*) FROM `Parts` AS `t1` JOIN `Asset_Parts` AS `t2` ON `t1`.`part_id` = `t2`.`part_id` GROUP BY `t1`.`part_name`"
What are all the fault descriptions and the fault status of all the faults recoreded in the logs?,"SELECT `t1`.`fault_description`, `t2`.`fault_status` FROM `Fault_Log` AS `t1` JOIN `Fault_Log_Parts` AS `t2` ON `t1`.`fault_log_entry_id` = `t2`.`fault_log_entry_id`"
How many engineer visits are required at most for a single fault log? List the number and the log entry id.,"SELECT COUNT(*), `t1`.`fault_log_entry_id` FROM `Fault_Log` AS `t1` JOIN `Engineer_Visits` AS `t2` ON `t1`.`fault_log_entry_id` = `t2`.`fault_log_entry_id` GROUP BY `t1`.`fault_log_entry_id` ORDER BY COUNT(*) DESC LIMIT 1"
What are all the distinct last names of all the engineers?,SELECT DISTINCT `last_name` FROM `Maintenance_Engineers`
How many fault status codes are recorded in the fault log parts table?,SELECT DISTINCT `fault_status` FROM `Fault_Log_Parts`
Which engineers have never visited to maintain the assets? List the engineer first name and last name.,"SELECT `first_name`, `last_name` FROM `Maintenance_Engineers` WHERE NOT `engineer_id` IN (SELECT `engineer_id` FROM `Engineer_Visits`)"
"List the asset id, details, make and model for every asset.","SELECT `asset_id`, `asset_details`, `asset_make`, `asset_model` FROM `Assets`"
When was the first asset acquired?,SELECT `asset_acquired_date` FROM `Assets` ORDER BY `asset_acquired_date` ASC LIMIT 1
Which part fault requires the most number of skills to fix? List part id and name.,"SELECT `t1`.`part_id`, `t1`.`part_name` FROM `Parts` AS `t1` JOIN `Part_Faults` AS `t2` ON `t1`.`part_id` = `t2`.`part_id` JOIN `Skills_Required_To_Fix` AS `t3` ON `t2`.`part_fault_id` = `t3`.`part_fault_id` GROUP BY `t1`.`part_id`, `t1`.`part_name` ORDER BY COUNT(*) DESC LIMIT 1"
Which kind of part has the least number of faults? List the part name.,SELECT `t1`.`part_name` FROM `Parts` AS `t1` JOIN `Part_Faults` AS `t2` ON `t1`.`part_id` = `t2`.`part_id` GROUP BY `t1`.`part_name` ORDER BY COUNT(*) ASC LIMIT 1
"Among those engineers who have visited, which engineer makes the least number of visits? List the engineer id, first name and last name.","SELECT `t1`.`engineer_id`, `t1`.`first_name`, `t1`.`last_name` FROM `Maintenance_Engineers` AS `t1` JOIN `Engineer_Visits` AS `t2` ON `t1`.`engineer_id` = `t2`.`engineer_id` GROUP BY `t1`.`engineer_id`, `t1`.`first_name`, `t1`.`last_name` ORDER BY COUNT(*) ASC LIMIT 1"
Which staff have contacted which engineers? List the staff name and the engineer first name and last name.,"SELECT `t1`.`staff_name`, `t3`.`first_name`, `t3`.`last_name` FROM `Staff` AS `t1` JOIN `Engineer_Visits` AS `t2` ON `t1`.`staff_id` = `t2`.`contact_staff_id` JOIN `Maintenance_Engineers` AS `t3` ON `t2`.`engineer_id` = `t3`.`engineer_id`"
"Which fault log included the most number of faulty parts? List the fault log id, description and record time.","SELECT `t1`.`fault_log_entry_id`, `t1`.`fault_description`, `t1`.`fault_log_entry_datetime` FROM `Fault_Log` AS `t1` JOIN `Fault_Log_Parts` AS `t2` ON `t1`.`fault_log_entry_id` = `t2`.`fault_log_entry_id` GROUP BY `t1`.`fault_log_entry_id`, `t1`.`fault_description`, `t1`.`fault_log_entry_datetime` ORDER BY COUNT(*) DESC LIMIT 1"
Which skill is used in fixing the most number of faults? List the skill id and description.,"SELECT `t1`.`skill_id`, `t1`.`skill_description` FROM `Skills` AS `t1` JOIN `Skills_Required_To_Fix` AS `t2` ON `t1`.`skill_id` = `t2`.`skill_id` GROUP BY `t1`.`skill_id`, `t1`.`skill_description` ORDER BY COUNT(*) DESC LIMIT 1"
What are all the distinct asset models?,SELECT DISTINCT `asset_model` FROM `Assets`
"List the all the assets make, model, details by the disposed date ascendingly.","SELECT `asset_make`, `asset_model`, `asset_details` FROM `Assets` ORDER BY `asset_disposed_date` ASC"
Which part has the least chargeable amount? List the part id and amount.,"SELECT `part_id`, `chargeable_amount` FROM `Parts` ORDER BY `chargeable_amount` ASC LIMIT 1"
Which company started the earliest the maintenance contract? Show the company name.,SELECT `t1`.`company_name` FROM `Third_Party_Companies` AS `t1` JOIN `Maintenance_Contracts` AS `t2` ON `t1`.`company_id` = `t2`.`maintenance_contract_company_id` ORDER BY `t2`.`contract_start_date` ASC LIMIT 1
What is the description of the type of the company who concluded its contracts most recently?,"SELECT `c`.`company_type`, `c`.`company_name`, `c`.`company_address`, `c`.`other_company_details` FROM `assets_maintenance`.`Third_Party_Companies` AS `c` JOIN `assets_maintenance`.`Maintenance_Contracts` AS `mc` ON `c`.`company_id` = `mc`.`maintenance_contract_company_id` WHERE `mc`.`contract_end_date` = (SELECT MAX(`contract_end_date`) FROM `assets_maintenance`.`Maintenance_Contracts`)"
Which gender makes up the majority of the staff?,SELECT `gender` FROM `Staff` GROUP BY `gender` ORDER BY COUNT(*) DESC LIMIT 1
How many engineers did each staff contact? List both the contact staff name and number of engineers contacted.,"SELECT `t1`.`staff_name`, COUNT(*) FROM `Staff` AS `t1` JOIN `Engineer_Visits` AS `t2` ON `t1`.`staff_id` = `t2`.`contact_staff_id` GROUP BY `t1`.`staff_name`"
Which assets did not incur any fault log? List the asset model.,SELECT `asset_model` FROM `Assets` WHERE NOT `asset_id` IN (SELECT `asset_id` FROM `Fault_Log`)
