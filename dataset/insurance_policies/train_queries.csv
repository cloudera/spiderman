question,sql
Which claims caused more than 2 settlements or have the maximum claim value? List the date the claim was made and the claim id.,"SELECT `t1`.`Date_Claim_Made`, `t1`.`Claim_id` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`Claim_id` = `t2`.`Claim_id` GROUP BY `t1`.`Date_Claim_Made`, `t1`.`Claim_id` HAVING COUNT(*) > 2 UNION SELECT `t1`.`Date_Claim_Made`, `t1`.`Claim_id` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`Claim_id` = `t2`.`Claim_id` WHERE `t1`.`Amount_Claimed` = (SELECT MAX(`Amount_Claimed`) FROM `Claims`)"
"Find the claims that led to more than two settlements or have the maximum claim value. For each of them, return the date the claim was made and the id of the claim.","SELECT `t1`.`Date_Claim_Made`, `t1`.`Claim_id` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`Claim_id` = `t2`.`Claim_id` GROUP BY `t1`.`Date_Claim_Made`, `t1`.`Claim_id` HAVING COUNT(*) > 2 UNION SELECT `t1`.`Date_Claim_Made`, `t1`.`Claim_id` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`Claim_id` = `t2`.`Claim_id` WHERE `t1`.`Amount_Claimed` = (SELECT MAX(`Amount_Claimed`) FROM `Claims`)"
Which customer had at least 2 policies but did not file any claims? List the customer details and id.,"SELECT `t1`.`customer_details`, `t1`.`customer_id` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`Customer_id` = `t2`.`customer_id` GROUP BY `t1`.`customer_details`, `t1`.`customer_id` HAVING COUNT(*) >= 2 EXCEPT SELECT `t1`.`customer_details`, `t1`.`customer_id` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`Customer_id` = `t2`.`customer_id` JOIN `Claims` AS `t3` ON `t2`.`policy_id` = `t3`.`policy_id`"
Give me the the customer details and id for the customers who had two or more policies but did not file any claims.,"SELECT `t1`.`customer_details`, `t1`.`customer_id` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`Customer_id` = `t2`.`customer_id` GROUP BY `t1`.`customer_details`, `t1`.`customer_id` HAVING COUNT(*) >= 2 EXCEPT SELECT `t1`.`customer_details`, `t1`.`customer_id` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`Customer_id` = `t2`.`customer_id` JOIN `Claims` AS `t3` ON `t2`.`policy_id` = `t3`.`policy_id`"
"List the method, date and amount of all the payments, in ascending order of date.","SELECT `Payment_Method_Code`, `Date_Payment_Made`, `Amount_Payment` FROM `Payments` ORDER BY `Date_Payment_Made` ASC"
"What are the method, date and amount of each payment? Sort the list in ascending order of date.","SELECT `Payment_Method_Code`, `Date_Payment_Made`, `Amount_Payment` FROM `Payments` ORDER BY `Date_Payment_Made` ASC"
"Among all the claims, what is the settlement amount of the claim with the largest claim amount? List both the settlement amount and claim amount.","SELECT `Amount_Settled`, `Amount_Claimed` FROM `Claims` ORDER BY `Amount_Claimed` DESC LIMIT 1"
Find the settlement amount of the claim with the largest claim amount. Show both the settlement amount and claim amount.,"SELECT `Amount_Settled`, `Amount_Claimed` FROM `Claims` ORDER BY `Amount_Claimed` DESC LIMIT 1"
"Among all the claims, what is the amount claimed in the claim with the least amount settled? List both the settlement amount and claim amount.","SELECT `Amount_Settled`, `Amount_Claimed` FROM `Claims` ORDER BY `Amount_Settled` ASC LIMIT 1"
Find the claimed amount in the claim with the least amount settled. Show both the settlement amount and claim amount.,"SELECT `Amount_Settled`, `Amount_Claimed` FROM `Claims` ORDER BY `Amount_Settled` ASC LIMIT 1"
"Among all the claims, which claims have a claimed amount larger than the average? List the date the claim was made and the date it was settled.","SELECT `Date_Claim_Made`, `Date_Claim_Settled` FROM `Claims` WHERE `Amount_Claimed` > (SELECT AVG(`Amount_Claimed`) FROM `Claims`)"
"Give me the claim date, settlement date for all the claims whose claimed amount is larger than the average.","SELECT `Date_Claim_Made`, `Date_Claim_Settled` FROM `Claims` WHERE `Amount_Claimed` > (SELECT AVG(`Amount_Claimed`) FROM `Claims`)"
"Among all the claims, which settlements have a claimed amount that is no more than the average? List the claim start date.",SELECT `Date_Claim_Made` FROM `Claims` WHERE `Amount_Settled` <= (SELECT AVG(`Amount_Settled`) FROM `Claims`)
Return the claim start date for the claims whose claimed amount is no more than the average,SELECT `Date_Claim_Made` FROM `Claims` WHERE `Amount_Settled` <= (SELECT AVG(`Amount_Settled`) FROM `Claims`)
How many settlements does each claim correspond to? List the claim id and the number of settlements.,"SELECT `t1`.`Claim_id`, COUNT(*) FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`claim_id` = `t2`.`claim_id` GROUP BY `t1`.`Claim_id`"
Find the number of settlements each claim corresponds to. Show the number together with the claim id.,"SELECT `t1`.`Claim_id`, COUNT(*) FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`claim_id` = `t2`.`claim_id` GROUP BY `t1`.`Claim_id`"
"Which claim incurred the most number of settlements? List the claim id, the date the claim was made, and the number.","SELECT `t1`.`claim_id`, `t1`.`date_claim_made`, COUNT(*) FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`claim_id` = `t2`.`claim_id` GROUP BY `t1`.`claim_id`, `t1`.`date_claim_made` ORDER BY COUNT(*) DESC LIMIT 1"
Find the claim id and claim date of the claim that incurred the most settlement count. Also tell me the count.,"SELECT `t1`.`claim_id`, `t1`.`date_claim_made`, COUNT(*) FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`claim_id` = `t2`.`claim_id` GROUP BY `t1`.`claim_id`, `t1`.`date_claim_made` ORDER BY COUNT(*) DESC LIMIT 1"
How many settlements were made on the claim with the most recent claim settlement date? List the number and the claim id.,"SELECT COUNT(*), `t1`.`claim_id` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`claim_id` = `t2`.`claim_id` GROUP BY `t1`.`claim_id` ORDER BY `t1`.`Date_Claim_Settled` DESC LIMIT 1"
Find the claim id and the number of settlements made for the claim with the most recent settlement date.,"SELECT COUNT(*), `t1`.`claim_id` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`claim_id` = `t2`.`claim_id` GROUP BY `t1`.`claim_id` ORDER BY `t1`.`Date_Claim_Settled` DESC LIMIT 1"
"Of all the claims, what was the earliest date when any claim was made?",SELECT `Date_Claim_Made` FROM `Claims` ORDER BY `Date_Claim_Made` ASC LIMIT 1
Tell me the the date when the first claim was made.,SELECT `Date_Claim_Made` FROM `Claims` ORDER BY `Date_Claim_Made` ASC LIMIT 1
What is the total amount of settlement made for all the settlements?,SELECT SUM(`Amount_Settled`) FROM `Settlements`
Compute the total amount of settlement across all the settlements.,SELECT SUM(`Amount_Settled`) FROM `Settlements`
Who are the customers that had more than 1 policy? List the customer details and id.,"SELECT `t1`.`customer_details`, `t1`.`customer_id` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`Customer_id` = `t2`.`Customer_id` GROUP BY `t1`.`customer_details`, `t1`.`customer_id` HAVING COUNT(*) > 1"
Find the the customer details and id for the customers who had more than one policy.,"SELECT `t1`.`customer_details`, `t1`.`customer_id` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`Customer_id` = `t2`.`Customer_id` GROUP BY `t1`.`customer_details`, `t1`.`customer_id` HAVING COUNT(*) > 1"
What are the claim dates and settlement dates of all the settlements?,"SELECT `Date_Claim_Made`, `Date_Claim_Settled` FROM `Settlements`"
Tell me the the claim date and settlement date for each settlement case.,"SELECT `Date_Claim_Made`, `Date_Claim_Settled` FROM `Settlements`"
What is the most popular payment method?,SELECT `Payment_Method_Code` FROM `Payments` GROUP BY `Payment_Method_Code` ORDER BY COUNT(*) DESC LIMIT 1
Which payment method is used the most often?,SELECT `Payment_Method_Code` FROM `Payments` GROUP BY `Payment_Method_Code` ORDER BY COUNT(*) DESC LIMIT 1
With which kind of payment method were the least number of payments processed?,SELECT `Payment_Method_Code` FROM `Payments` GROUP BY `Payment_Method_Code` ORDER BY COUNT(*) ASC LIMIT 1
What is the payment method that were used the least often?,SELECT `Payment_Method_Code` FROM `Payments` GROUP BY `Payment_Method_Code` ORDER BY COUNT(*) ASC LIMIT 1
What is the total amount of payment?,SELECT SUM(`Amount_Payment`) FROM `Payments`
Compute the total amount of payment processed.,SELECT SUM(`Amount_Payment`) FROM `Payments`
What are all the distinct details of the customers?,SELECT DISTINCT `customer_details` FROM `Customers`
Return the distinct customer details.,SELECT DISTINCT `customer_details` FROM `Customers`
Which kind of policy type was chosen by the most customers?,SELECT `Policy_Type_Code` FROM `Customer_Policies` GROUP BY `Policy_Type_Code` ORDER BY COUNT(*) DESC LIMIT 1
Find the policy type the most customers choose.,SELECT `Policy_Type_Code` FROM `Customer_Policies` GROUP BY `Policy_Type_Code` ORDER BY COUNT(*) DESC LIMIT 1
How many settlements are there in total?,SELECT COUNT(*) FROM `Settlements`
Count the total number of settlements made.,SELECT COUNT(*) FROM `Settlements`
"Which Payments were processed with Visa? List the payment Id, the date and the amount.","SELECT `Payment_ID`, `Date_Payment_Made`, `Amount_Payment` FROM `Payments` WHERE `Payment_Method_Code` = 'Visa'"
"Give me the payment Id, the date and the amount for all the payments processed with Visa.","SELECT `Payment_ID`, `Date_Payment_Made`, `Amount_Payment` FROM `Payments` WHERE `Payment_Method_Code` = 'Visa'"
List the details of the customers who do not have any policies.,SELECT `customer_details` FROM `Customers` EXCEPT SELECT `t1`.`customer_details` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id`
Which customers do not have any policies? Find the details of these customers.,SELECT `customer_details` FROM `Customers` EXCEPT SELECT `t1`.`customer_details` FROM `Customers` AS `t1` JOIN `Customer_Policies` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id`
"List the date the claim was made, the date it was settled and the amount settled for all the claims which had exactly one settlement.","SELECT `t1`.`claim_id`, `t1`.`date_claim_made`, `t1`.`Date_Claim_Settled` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`Claim_id` = `t2`.`Claim_id` GROUP BY `t1`.`claim_id`, `t1`.`date_claim_made`, `t1`.`Date_Claim_Settled` HAVING COUNT(*) = 1"
"Which claims had exactly one settlement? For each, tell me the the date the claim was made, the date it was settled and the amount settled.","SELECT `t1`.`claim_id`, `t1`.`date_claim_made`, `t1`.`Date_Claim_Settled` FROM `Claims` AS `t1` JOIN `Settlements` AS `t2` ON `t1`.`Claim_id` = `t2`.`Claim_id` GROUP BY `t1`.`claim_id`, `t1`.`date_claim_made`, `t1`.`Date_Claim_Settled` HAVING COUNT(*) = 1"
Find the total claimed amount of all the claims.,SELECT SUM(`Amount_Claimed`) FROM `Claims`
What is total amount claimed summed across all the claims?,SELECT SUM(`Amount_Claimed`) FROM `Claims`
