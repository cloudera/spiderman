question,sql
How many premises are there?,SELECT COUNT(*) FROM `Premises`
What are all the distinct premise types?,SELECT DISTINCT `premises_type` FROM `Premises`
Find the types and details for all premises and order by the premise type.,"SELECT `premises_type`, `premise_details` FROM `Premises` ORDER BY `premises_type`"
Show each premise type and the number of premises in that type.,"SELECT `premises_type`, COUNT(*) FROM `Premises` GROUP BY `premises_type`"
Show all distinct product categories along with the number of mailshots in each category.,"SELECT `product_category`, COUNT(*) FROM `Mailshot_Campaigns` GROUP BY `product_category`"
Show the name and phone of the customer without any mailshot.,"SELECT `customer_name`, `customer_phone` FROM `Customers` WHERE NOT `customer_id` IN (SELECT `customer_id` FROM `Mailshot_Customers`)"
Show the name and phone for customers with a mailshot with outcome code 'No Response'.,"SELECT `t1`.`customer_name`, `t1`.`customer_phone` FROM `Customers` AS `t1` JOIN `Mailshot_Customers` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `t2`.`outcome_code` = 'No Response'"
Show the outcome code of mailshots along with the number of mailshots in each outcome code.,"SELECT `outcome_code`, COUNT(*) FROM `Mailshot_Customers` GROUP BY `outcome_code`"
Show the names of customers who have at least 2 mailshots with outcome code 'Order'.,SELECT `t2`.`customer_name` FROM `Mailshot_Customers` AS `t1` JOIN `Customers` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `outcome_code` = 'Order' GROUP BY `t2`.`customer_name` HAVING COUNT(*) >= 2
Show the names of customers who have the most mailshots.,SELECT `t2`.`customer_name` FROM `Mailshot_Customers` AS `t1` JOIN `Customers` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` GROUP BY `t2`.`customer_name` ORDER BY COUNT(*) DESC LIMIT 1
What are the name and payment method of customers who have both mailshots in 'Order' outcome and mailshots in 'No Response' outcome.,"SELECT `t2`.`customer_name`, `t2`.`payment_method` FROM `Mailshot_Customers` AS `t1` JOIN `Customers` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `t1`.`outcome_code` = 'Order' INTERSECT SELECT `t2`.`customer_name`, `t2`.`payment_method` FROM `Mailshot_Customers` AS `t1` JOIN `Customers` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `t1`.`outcome_code` = 'No Response'"
Show the premise type and address type code for all customer addresses.,"SELECT `t2`.`premises_type`, `t1`.`address_type_code` FROM `Customer_Addresses` AS `t1` JOIN `Premises` AS `t2` ON `t1`.`premise_id` = `t2`.`premise_id`"
What are the distinct address type codes for all customer addresses?,SELECT DISTINCT `address_type_code` FROM `Customer_Addresses`
Show the shipping charge and customer id for customer orders with order status Cancelled or Paid.,"SELECT `order_shipping_charges`, `customer_id` FROM `Customer_Orders` WHERE `order_status_code` = 'Cancelled' OR `order_status_code` = 'Paid'"
Show the names of customers having an order with shipping method FedEx and order status Paid.,SELECT `t1`.`customer_name` FROM `Customers` AS `t1` JOIN `Customer_Orders` AS `t2` ON `t1`.`customer_id` = `t2`.`customer_id` WHERE `shipping_method_code` = 'FedEx' AND `order_status_code` = 'Paid'
